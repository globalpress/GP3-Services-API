const input = {
  colors: {
    "brand-dark-gray": {
      50: "#7E7E77",
      100: "#76766F",
      200: "#696963",
      300: "#61615C",
      400: "#595954",
      500: "#4A4A45",
      600: "#3F3F3B",
      700: "#373734",
      800: "#32322F",
      900: "#2A2A28",
      950: "#20201E",
      1000: "#1B1B18",
    },
    "brand-light-gray": {
      50: "#F8F8F7",
      100: "#F3F3F1",
      200: "#EFEFEC",
      300: "#E7E7E4",
      400: "#E0E0DC",
      500: "#D9D9D4",
      600: "#CFCFC9",
      700: "#C7C7C1",
      800: "#C0C0B9",
      900: "#B6B6AF",
      950: "#ACACA5",
    },
  },
  spacing: {
    0: "0px",
    1: "4px",
    2: "8px",
    3: "12px",
    4: "16px",
    5: "5px",
    6: "24px",
    7: "28px",
    8: "32px",
    9: "36px",
    10: "10px",
    11: "44px",
    12: "48px",
    14: "56px",
    16: "64px",
    20: "20px",
    24: "96px",
    28: "112px",
    32: "128px",
    36: "144px",
    40: "40px",
    44: "176px",
    48: "192px",
    52: "208px",
    56: "224px",
    60: "60px",
    64: "256px",
    72: "288px",
    80: "80px",
    96: "0px",
    999: "999px",
    px: "1px",
    "0․5": "2px",
    "1․5": "6px",
    "2․5": "10px",
    "3․5": "14px",
  },
};

const output = {
  colors: [
    {
      name: "brand-dark-gray-50",
      value: "#7E7E77",
    },
    {
      name: "brand-dark-gray-100",
      value: "#76766F",
    },
    {
      name: "brand-dark-gray-200",
      value: "#696963",
    },
    {
      name: "brand-dark-gray-300",
      value: "#61615C",
    },
    {
      name: "brand-dark-gray-400",
      value: "#595954",
    },
    {
      name: "brand-dark-gray-500",
      value: "#4A4A45",
    },
    {
      name: "brand-dark-gray-600",
      value: "#3F3F3B",
    },
    {
      name: "brand-dark-gray-700",
      value: "#373734",
    },
    {
      name: "brand-dark-gray-800",
      value: "#32322F",
    },
    {
      name: "brand-dark-gray-900",
      value: "#2A2A28",
    },
    {
      name: "brand-dark-gray-950",
      value: "#20201E",
    },
    {
      name: "brand-dark-gray-1000",
      value: "#1B1B18",
    },
    {
      name: "brand-light-gray-50",
      value: "#F8F8F7",
    },
    {
      name: "brand-light-gray-100",
      value: "#F3F3F1",
    },
    {
      name: "brand-light-gray-200",
      value: "#EFEFEC",
    },
    {
      name: "brand-light-gray-300",
      value: "#E7E7E4",
    },
    {
      name: "brand-light-gray-400",
      value: "#E0E0DC",
    },
    {
      name: "brand-light-gray-500",
      value: "#D9D9D4",
    },
    {
      name: "brand-light-gray-600",
      value: "#CFCFC9",
    },
    {
      name: "brand-light-gray-700",
      value: "#C7C7C1",
    },
    {
      name: "brand-light-gray-800",
      value: "#C0C0B9",
    },
    {
      name: "brand-light-gray-900",
      value: "#B6B6AF",
    },
    {
      name: "brand-light-gray-950",
      value: "#ACACA5",
    },
  ],
  spacing: [
    {
      name: "spacing-0",
      value: "0px",
    },
    {
      name: "spacing-1",
      value: "4px",
    },
    {
      name: "spacing-2",
      value: "8px",
    },
    {
      name: "spacing-3",
      value: "12px",
    },
    {
      name: "spacing-4",
      value: "16px",
    },
    {
      name: "spacing-5",
      value: "5px",
    },
    {
      name: "spacing-6",
      value: "24px",
    },
    {
      name: "spacing-7",
      value: "28px",
    },
    {
      name: "spacing-8",
      value: "32px",
    },
    {
      name: "spacing-9",
      value: "36px",
    },
    {
      name: "spacing-10",
      value: "10px",
    },
    {
      name: "spacing-11",
      value: "44px",
    },
    {
      name: "spacing-12",
      value: "48px",
    },
    {
      name: "spacing-14",
      value: "56px",
    },
    {
      name: "spacing-16",
      value: "64px",
    },
    {
      name: "spacing-20",
      value: "20px",
    },
    {
      name: "spacing-24",
      value: "96px",
    },
    {
      name: "spacing-28",
      value: "112px",
    },
    {
      name: "spacing-32",
      value: "128px",
    },
    {
      name: "spacing-36",
      value: "144px",
    },
    {
      name: "spacing-40",
      value: "40px",
    },
    {
      name: "spacing-44",
      value: "176px",
    },
    {
      name: "spacing-48",
      value: "192px",
    },
    {
      name: "spacing-52",
      value: "208px",
    },
    {
      name: "spacing-56",
      value: "224px",
    },
    {
      name: "spacing-60",
      value: "60px",
    },
    {
      name: "spacing-64",
      value: "256px",
    },
    {
      name: "spacing-72",
      value: "288px",
    },
    {
      name: "spacing-80",
      value: "80px",
    },
    {
      name: "spacing-96",
      value: "0px",
    },
    {
      name: "spacing-999",
      value: "999px",
    },
    {
      name: "spacing-px",
      value: "1px",
    },
    {
      name: "spacing-0․5",
      value: "2px",
    },
    {
      name: "spacing-1․5",
      value: "6px",
    },
    {
      name: "spacing-2․5",
      value: "10px",
    },
    {
      name: "spacing-3․5",
      value: "14px",
    },
  ],
};

function convertInputToOutput(input) {
  const output = {};

  for (const [key, values] of Object.entries(input)) {
    output[key] = [];
    for (const [subKey, subValues] of Object.entries(values)) {
      if (typeof subValues === "object" && subValues !== null) {
        for (const [subSubKey, value] of Object.entries(subValues)) {
          output[key].push({
            name: `${subKey}-${subSubKey}`,
            value: `${subKey}-${subSubKey}`,
          });
        }
      } else {
        output[key].push({
          name: `${subValues} (${subKey})`,
          value: subKey,
        });
      }
    }
  }

  return output;
}
const out = convertInputToOutput(input);

// console.log(out);

/**
 * Converts a flat object into a nested object based on the keys.
 * @param {Object} input - The flat object to be converted.
 * @returns {Object} - The nested object.
 */
const snakeCaseUnderscoredClassKeysToDeepNested = (input) => {
  const output = {};
  for (const key in input) {
    const keyParts = key.split("_");
    if (
      keyParts.length !== 1 &&
      keyParts.includes("class") &&
      input[key] !== "" &&
      typeof input[key] === "string"
    ) {
      let current = output;
      for (let i = 0; i < keyParts.length - 1; i++) {
        const part = keyParts[i];
        if (!current[part]) {
          current[part] = {};
        }
        current = current[part];
      }
      current[keyParts[keyParts.length - 1]] = input[key];
    }
  }
  return output;
};

let blok = {
  pb: "24",
  pt: "24",
  _uid: "ee4979e4-5337-41a9-9eb7-2ae8906cef17",
  json: "",
  size: "full",
  media: {
    id: null,
    alt: "",
    name: "",
    focus: "",
    title: "",
    source: "",
    filename:
      "https://gpjs3bucket.s3.amazonaws.com/wp-content/uploads/2022/11/04090527/Mercury-Mining-Lead-1.mp4",
    copyright: "",
    fieldtype: "asset",
    meta_data: {},
    is_private: false,
    class_color_is_external_url: true,
  },
  overlay: "",
  position: "static",
  component: "StorySection",
  containers: [
    {
      _uid: "960855d0-5334-4f82-814c-8ab5c3c6620d",
      Width: "sm",
      blocks: [
        {
          _uid: "a096d5d6-7765-4e07-9420-fb2033c7628c",
          blocks: [
            {
              _uid: "7309dd46-6e86-4158-b082-af92f9e6024f",
              component: "Heading",
              overlay_class_color_text: "white",
              overlay_class_align_text: "center",
              overlay_class_size_text: "3xl",
              overlay_class_color_bg: "black",
              overlay_class_spacing_p: "4",
              heading_class_size_text: "3xl",
              _editable:
                '<!--#storyblok#{"name": "Heading", "space": "287471", "uid": "7309dd46-6e86-4158-b082-af92f9e6024f", "id": "489682032"}-->',
            },
            {
              _uid: "3d164e8e-8d00-493a-aa27-d0effb79f6b6",
              component: "Heading",
              textColor: "white",
              headingSize: "7xl",
              headingText: "Heading 2",
              headingAlign: "center",
              headingLevel: "2",
              headingStyle: "ptserif",
              _editable:
                '<!--#storyblok#{"name": "Heading", "space": "287471", "uid": "3d164e8e-8d00-493a-aa27-d0effb79f6b6", "id": "489682032"}-->',
            },
          ],
          component: "SpacingGroup",
          elementSpacing: "1",
          _editable:
            '<!--#storyblok#{"name": "SpacingGroup", "space": "287471", "uid": "a096d5d6-7765-4e07-9420-fb2033c7628c", "id": "489682032"}-->',
        },
      ],
      component: "StoryContainer",
      _editable:
        '<!--#storyblok#{"name": "StoryContainer", "space": "287471", "uid": "960855d0-5334-4f82-814c-8ab5c3c6620d", "id": "489682032"}-->',
    },
  ],
  scrolltriggerEnd: "",
  scrolltriggerStart: "",
  some_class_is_of: "asasa",
  mediaOverlayBgColor: "brand-dark-gray-700",
  mediaOverlayBgOpacity: "50",
  _editable:
    '<!--#storyblok#{"name": "StorySection", "space": "287471", "uid": "ee4979e4-5337-41a9-9eb7-2ae8906cef17", "id": "489682032"}-->',
};

let options = {
  as_class_sasa_asa: "",
  voverlay_class_color_text: "white",
  overlay_class_color_text: "white",
  overlay_class_align_text: "center",
  overlay_class_size_clamptext: "3xl",
  overlay_class_color_bg: "black",
  overlay_class_spacing_p: "4",
  heading_class_size_text: "3xl",
  label_class_transform: "uppercase",
  spgroup_class_space_space_y: "3xl",
  spgroup_class_space_open_space_y: "3xl",
};

function getBlockClasses(input) {
  let output = {};

  input = snakeCaseUnderscoredClassKeysToDeepNested(input);

  const recursive = (obj, path = []) => {
    for (let key in obj) {
      if (typeof obj[key] === "object" && !Array.isArray(obj[key])) {
        recursive(obj[key], path.concat(key));
      } else {
        let classPath = path.concat(key, obj[key]).join("-");
        let mainKey = path[0];
        if (!output[mainKey]) {
          output[mainKey] = { class: [] };
        }
        classPath = classPath.split("-").slice(3).join("-");

        output[mainKey].class.push(classPath);
      }
    }
  };

  recursive(input);
  return output;
}

let outt = getBlockClasses(options);
console.log(outt);
